{% extends "base.html" %}

{% block title %}Dashboard - Phân tích COVID-19 & Kinh tế{% endblock %}

{% block content %}
<div class="dashboard-page">
    <div class="container">
        <!-- Header -->
        <div class="page-header">
            <h1><i class="fas fa-chart-bar"></i> Dashboard Phân tích</h1>
            <p>Dữ liệu từ {{ stats.date_range }}</p>
        </div>

        <!-- Stats Overview -->
        <div class="stats-overview">
            <div class="stat-box">
                <i class="fas fa-database"></i>
                <div class="stat-content">
                    <h3>{{ stats.total_records }}</h3>
                    <p>Tổng bản ghi</p>
                </div>
            </div>
            <div class="stat-box">
                <i class="fas fa-users-slash"></i>
                <div class="stat-content">
                    <h3>{{ stats.avg_unemployment }}%</h3>
                    <p>TB Thất nghiệp</p>
                </div>
            </div>
        </div>
        <div class="stats-overview">
            <div class="stat-box">
                <i class="fas fa-chart-line"></i>
                <div class="stat-content">
                    <h3>{{ stats.avg_gdp_growth }}%</h3>
                    <p>TB Tăng trưởng GDP</p>
                </div>
            </div>
            <div class="stat-box">
                <i class="fas fa-virus"></i>
                <div class="stat-content">
                    <h3>{{ "{:,}".format(stats.total_covid_cases) }}</h3>
                    <p>Tổng ca COVID</p>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs-container">
            <div class="tabs">
                <button class="tab-btn active" data-tab="economy">
                    <i class="fas fa-chart-line"></i> Kinh tế
                </button>
                <button class="tab-btn" data-tab="covid">
                    <i class="fas fa-virus"></i> COVID-19
                </button>
                <button class="tab-btn" data-tab="impact">
                    <i class="fas fa-project-diagram"></i> Tác động
                </button>
            </div>
        </div>

        <!-- Tab: Economy -->
        <div class="tab-content active" id="economy-tab">
            <div class="chart-card">
                <div class="chart-header">
                    <h3><i class="fas fa-chart-line"></i> Chỉ số Kinh tế theo Thời gian</h3>
                    <div class="chart-controls">
                        <select id="economy-metric">
                            <option value="unemployment_rate">Tỷ lệ Thất nghiệp</option>
                            <option value="gdp_growth">Tăng trưởng GDP</option>
                            <option value="stock_index">Chỉ số Chứng khoán</option>
                            <option value="retail_sales">Doanh thu Bán lẻ</option>
                        </select>
                    </div>
                </div>
                <div id="economy-timeseries" class="chart-container"></div>
            </div>

            <!-- Distribution -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3><i class="fas fa-chart-bar"></i> Phân phối Dữ liệu</h3>
                    <div class="chart-controls">
                        <select id="distribution-metric">
                            <option value="unemployment_rate">Tỷ lệ Thất nghiệp</option>
                            <option value="gdp_growth">Tăng trưởng GDP</option>
                            <option value="stock_index">Chỉ số Chứng khoán</option>
                            <option value="retail_sales">Doanh thu Bán lẻ</option>
                        </select>
                        <select id="distribution-type">
                            <option value="histogram">Histogram</option>
                            <option value="box">Boxplot</option>
                            <option value="violin">Violin Plot</option>
                        </select>
                    </div>
                </div>
                <div id="economy-distribution" class="chart-container"></div>
            </div>

            <!-- Heatmap & Sunburst -->
            <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-fire"></i> Ma trận Tương quan</h3>
                    </div>
                    <div id="economy-heatmap" class="chart-container"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-circle-notch"></i> Sunburst Chart</h3>
                    </div>
                    <div id="economy-sunburst" class="chart-container"></div>
                </div>

            <!-- Comparison Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3><i class="fas fa-layer-group"></i> So sánh Đa chỉ số</h3>
                </div>
                <div id="economy-comparison" class="chart-container"></div>
            </div>
        </div>

        <!-- Tab: COVID -->
        <div class="tab-content" id="covid-tab">
            <!-- COVID Time Series -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3><i class="fas fa-virus"></i> COVID-19 Time Series</h3>
                    <div class="chart-controls">
                        <select id="covid-metric">
                            <option value="cases">Số ca nhiễm</option>
                            <option value="deaths">Số ca tử vong</option>
                            <option value="recovered">Số ca hồi phục</option>
                        </select>
                        <label>
                            <input type="checkbox" id="covid-show-ma" checked>
                            Hiện Moving Average
                        </label>
                    </div>
                </div>
                <div id="covid-timeseries" class="chart-container"></div>
            </div>

            <!-- COVID Treemap -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3><i class="fas fa-th"></i> Treemap - Ca mới theo Tháng</h3>
                </div>
                <div id="covid-treemap" class="chart-container"></div>
            </div>
        </div>

        <!-- Tab: Impact -->
        <div class="tab-content" id="impact-tab">
            <!-- Scatter Plot -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3><i class="fas fa-braille"></i> Scatter Plot - Correlation</h3>
                    <div class="chart-controls">
                        <select id="scatter-x">
                            <option value="unemployment_rate">Tỷ lệ Thất nghiệp</option>
                            <option value="gdp_growth">Tăng trưởng GDP</option>
                            <option value="stock_index">Chỉ số Chứng khoán</option>
                            <option value="retail_sales">Doanh thu Bán lẻ</option>
                        </select>
                        <span>vs</span>
                        <select id="scatter-y">
                            <option value="cases" selected>Số ca COVID</option>
                            <option value="deaths">Số ca tử vong</option>
                        </select>
                    </div>
                </div>
                <div id="economy-scatter" class="chart-container"></div>
            </div>

            <!-- Impact Analysis -->
            <div class="chart-card">
                <div class="chart-header">
                    <h3><i class="fas fa-project-diagram"></i> Phân tích Tác động COVID → Kinh tế</h3>
                </div>
                <div id="impact-analysis" class="chart-container"></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}